<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Product</title>
</head>
<body class="w-full h-screen">
    <nav class="bg-gray-800">
        <div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
          <div class="relative flex h-16 items-center justify-between">
            <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
              <!-- Mobile menu button-->
              <button type="button" class="inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false">
                <span class="sr-only">Open main menu</span>
                <!--
                  Icon when menu is closed.
      
                  Heroicon name: outline/bars-3
      
                  Menu open: "hidden", Menu closed: "block"
                -->
                <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                </svg>
                <!--
                  Icon when menu is open.
      
                  Heroicon name: outline/x-mark
      
                  Menu open: "block", Menu closed: "hidden"
                -->
                <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
            <div class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start">
              <div class="flex flex-shrink-0 items-center">
                <img class="block h-8 w-auto lg:hidden" src="https://tailwindui.com/img/logos/mark.svg?color=indigo&shade=500" alt="Your Company">
                <img class="hidden h-8 w-auto lg:block" src="https://tailwindui.com/img/logos/mark.svg?color=indigo&shade=500" alt="Your Company">
              </div>
              <div class="hidden sm:ml-6 sm:block">
                <div class="flex space-x-4">
                  <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
                  <a href="#" class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium" aria-current="page">Dashboard</a>
      
                  <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Team</a>
      
                  <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Projects</a>
      
                  <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Calendar</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <!-- Mobile menu, show/hide based on menu state. -->
        <div class="sm:hidden" id="mobile-menu">
          <div class="space-y-1 px-2 pt-2 pb-3">
            <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
            <a href="#" class="bg-gray-900 text-white block px-3 py-2 rounded-md text-base font-medium" aria-current="page">Dashboard</a>
      
            <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Team</a>
      
            <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Projects</a>
      
            <a href="#" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Calendar</a>
          </div>
        </div>
    </nav>
      <div class="grid grid-cols-6 gap-6 mx-[128px] py-[64px] inputs">
        <div class="col-span-6 sm:col-span-3">
          <label for="first-name" class="block text-sm font-medium text-gray-700">Name</label>
          <input type="text" name="name" id="name" placeholder="Name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
          <span id="error-name"  class="errors text-red-600 text-md"></span>
        </div>
        <div class="col-span-6 sm:col-span-3">
            <label for="price" class="block text-sm font-medium text-gray-700">Price</label>
            <input type="text" name="price" id="price" placeholder="price" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
            <span id="error-price"  class="errors text-red-600 text-md"></span>
        </div>
        <div class="col-span-6 sm:col-span-3">
            <label for="number" class="block text-sm font-medium text-gray-700">Number</label>
            <input type="text" name="number" id="number" placeholder="number" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
            <span id="error-number"  class="errors text-red-600 text-md"></span>
        </div>
        <div class="col-span-6 sm:col-span-3">
            <label for="color" class="block text-sm font-medium text-gray-700">Color</label>
            <input type="text" name="color" id="color" placeholder="color" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
            <span id="error-color"  class="errors text-red-600 text-md"></span>
        </div>
        <div class="col-span-6 sm:col-span-3 relative">
        <button class="add-product" class="px-4 py-2 bg-blue-600 rounded-[12px] absolute left-[100%] top-[24px] text-white mx-auto">Add</button>
        </div>
        
              
      </div>
      <div class="overflow-x-auto relative shadow-md sm:rounded-lg mx-[128px] py-[64px]">
        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                <tr>
                    <th scope="col" class="py-3 px-6">
                        Product name
                    </th>
                    <th scope="col" class="py-3 px-6">
                        Color
                    </th>
                    <th scope="col" class="py-3 px-6">
                        Number
                    </th>
                    <th scope="col" class="py-3 px-6">
                        Price
                    </th>
                    <th scope="col" class="py-3 px-6">
                        Action
                    </th>
                </tr>
            </thead>
            <tbody id="product-list">
         
            </tbody>
        </table>
    </div>
</body>
    <script type="text/javascript">

            window.onload = () => {
                new Product().print();
            
            }
            document.querySelector('.add-product').addEventListener('click',(e) => {
                e.preventDefault();
                let product = {}
                let validated = true;
                let inputs = document.querySelectorAll('input')
                let inputErrors = document.getElementsByClassName('errors')
                inputErrors = Array.prototype.slice.call(inputErrors)
                inputs =  Array.prototype.slice.call(inputs)
                inputErrors.forEach(el => el.innerHTML = '')
                inputs.forEach(column => {                
                    let columnName = column.getAttribute('name')
                    switch(columnName){
                        case 'name':
                            if(column.value.length === 0){
                                validated = false
                                new Product().printError(columnName)
                            }
                            break;
                        case 'price':
                            if(!/^[0-9]+$/.test(column.value) || (column.value < 0 || column.value > 100)){
                                validated = false
                                new Product().printError(columnName)
                            }
                            break;
                        case 'number':
                            if(!/^[0-9]+$/.test(column.value) || (column.value < 0 || column.value > 100)){
                                validated = false
                                new Product().printError(columnName)
                            }
                            break;
                        case 'color':
                            if(column.value.length === 0){
                                validated = false
                                new Product().printError(columnName)
                            }
                    }
                    product[columnName] =  column.value
                })
                if(validated){
                    let productInstance = new Product(product)
                    productInstance.create();
                    productInstance.print();
                    productInstance.updateLocalStorage();
                }
            })

            class Product{
                
                constructor(productItem = {}){
                    this.productItem = productItem
                    this.validationErrors = {
                        name : 'Name is required',
                        price : 'Price range must be more than 0 and less than 100',
                        color : 'Color is required',
                        number : 'Number is required'
                    }
                    this.products = localStorage.getItem('products') ? 
                    JSON.parse(localStorage.getItem('products')) : []
                    this.setProductItemId()
                    return this
                }

                setProductItemId()
                {
                    this.productItem['id'] = this.products.length + 1
                    return this.productItem
                }

                setModifiedDate()
                {
                    this.productItem['modified_date'] = Date.now()
                    return this.productItem

                }

                create() {
                    this.setModifiedDate()
                    this.products.push(this.productItem)
                    return this.products
                }

                edit () {
                    const product = this.products.find(product => product.id === this.productItem)
                    this.setModifiedDate();
                    this.products[product] = this.productItem
                    return this.products
                }

                remove () {
                    return this.products.filter(product => product.id !== this.productItem.id)
            
                }

                updateLocalStorage() {
                    localStorage.setItem('products',JSON.stringify(this.products))
                }

                append() {
                    document.getElementById('product-list').innerHTML+=`
                        <tr class="bg-white border-b dark:bg-gray-900 dark:border-gray-700">
                    <th scope="row" class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                        ${this.productItem.name}
                    </th>
                    <td class="py-4 px-6">
                        ${this.productItem.color}
                    </td>
                    <td class="py-4 px-6">
                        ${this.productItem.number}
                    </td>
                    <td class="py-4 px-6">
                        ${this.productItem.price}
                    </td>
                    <td class="py-4 px-6">
                        <a href="/delete/${this.productItem.id}" class="font-medium text-blue-600 dark:text-blue-500 hover:underline">Edit</a>
                    </td>
                </tr>
                        `
                }

                print () {
                    document.getElementById('product-list').innerHTML = '';
                    this.products.map(product => {
                        document.getElementById('product-list').innerHTML+=`
                        <tr class="bg-white border-b dark:bg-gray-900 dark:border-gray-700">
                    <th scope="row" class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                        ${product.name}
                    </th>
                    <td class="py-4 px-6">
                        ${product.color}
                    </td>
                    <td class="py-4 px-6">
                        ${product.number}
                    </td>
                    <td class="py-4 px-6">
                        ${product.price}
                    </td>
                    <td class="py-4 px-6">
                        <a href="/delete/${product.id}" class="font-medium text-blue-600 dark:text-blue-500 hover:underline">Edit</a>
                    </td>
                </tr>
                        `
                    })
                }

                printError(name)
                {
                   document.getElementById(`error-${name}`).innerHTML = this.validationErrors[name]
                }
            }
    </script>
    
</html>